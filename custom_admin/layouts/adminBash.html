{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Admin Dashboard{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Alpine.js for sidebar toggle -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 font-sans">

    <!-- Sidebar -->
    <div x-data="{ openMenu: null }" class="bg-gray-900 text-gray-200 w-64 min-h-screen fixed top-0 left-0 overflow-y-auto transition-all duration-300 sidebar">
        <!-- Logo -->
        <div class="flex items-center p-4 border-b border-gray-700">
            <img src="{% static 'logo/cuddlyduddly_logo.png' %}" alt="CuddlyDuddly Logo" class="h-8 w-auto mr-2">
            <h4 class="font-semibold text-lg">CuddlyDuddly</h4>
        </div>

        <!-- Dashboard -->
        <a href="{% url 'admin_dashboard' %}" class="block px-4 py-2 hover:bg-blue-600 rounded {% if request.resolver_match.url_name == 'admin_dashboard' %}bg-blue-700 text-white{% endif %}">
            <i class="bi bi-speedometer2 me-2"></i> Dashboard
        </a>

        <!-- Sellers Menu -->
        <div class="mt-2">
            <button @click="openMenu === 1 ? openMenu = null : openMenu = 1"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-shop me-2"></i> Sellers</span>
                <i :class="openMenu === 1 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 1" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_sellers_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_sellers_index' %}bg-gray-800 text-white{% endif %}">All Sellers</a>
                <a href="{% url 'admin_seller_applications' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_seller_applications' %}bg-gray-800 text-white{% endif %}">Seller Applications</a>
                <a href="{% url 'admin_payouts_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_payouts_index' %}bg-gray-800 text-white{% endif %}">Payouts</a>
                <a href="{% url 'admin_sellers_compliance' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_sellers_compliance' %}bg-gray-800 text-white{% endif %}">KYC / Compliance</a>
            </div>
        </div>

        <!-- Products Menu -->
        <div class="mt-2">
            <button @click="openMenu === 2 ? openMenu = null : openMenu = 2"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-box-seam me-2"></i> Products</span>
                <i :class="openMenu === 2 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 2" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_products_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_products_index' %}bg-gray-800 text-white{% endif %}">All Products</a>
                <a href="{% url 'admin_categories_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_categories_index' %}bg-gray-800 text-white{% endif %}">Categories</a>
                <a href="{% url 'admin_brands_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_brands_index' %}bg-gray-800 text-white{% endif %}">Brands</a>
                <a href="{% url 'admin_inventory_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_inventory_index' %}bg-gray-800 text-white{% endif %}">Inventory</a>
            </div>
        </div>

        <!-- Orders Menu -->
        <div class="mt-2">
            <button @click="openMenu === 3 ? openMenu = null : openMenu = 3"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-cart-check me-2"></i> Orders</span>
                <i :class="openMenu === 3 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 3" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_orders_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_orders_index' %}bg-gray-800 text-white{% endif %}">All Orders</a>
                <a href="{% url 'admin_returns_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_returns_index' %}bg-gray-800 text-white{% endif %}">Returns</a>
                <a href="{% url 'admin_cancellations_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_cancellations_index' %}bg-gray-800 text-white{% endif %}">Cancellations</a>
            </div>
        </div>

        <!-- Customers Menu -->
        <div class="mt-2">
            <button @click="openMenu === 4 ? openMenu = null : openMenu = 4"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-people me-2"></i> Customers</span>
                <i :class="openMenu === 4 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 4" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_customers_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_customers_index' %}bg-gray-800 text-white{% endif %}">All Customers</a>
                <a href="{% url 'admin_reviews_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_reviews_index' %}bg-gray-800 text-white{% endif %}">Reviews</a>
                <a href="{% url 'admin_wishlists_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_wishlists_index' %}bg-gray-800 text-white{% endif %}">Wishlists</a>
            </div>
        </div>

        <!-- Reports Menu -->
        <div class="mt-2">
            <button @click="openMenu === 5 ? openMenu = null : openMenu = 5"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-bar-chart me-2"></i> Reports</span>
                <i :class="openMenu === 5 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 5" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_reports_sales' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_reports_sales' %}bg-gray-800 text-white{% endif %}">Sales</a>
                <a href="{% url 'admin_reports_revenue' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_reports_revenue' %}bg-gray-800 text-white{% endif %}">Revenue</a>
                <a href="{% url 'admin_reports_seller' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_reports_seller' %}bg-gray-800 text-white{% endif %}">Seller Performance</a>
                <a href="{% url 'admin_reports_customer' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_reports_customer' %}bg-gray-800 text-white{% endif %}">Customer Insights</a>
            </div>
        </div>

        <!-- Settings Menu -->
        <div class="mt-2">
            <button @click="openMenu === 6 ? openMenu = null : openMenu = 6"
                    class="w-full flex items-center justify-between px-4 py-2 hover:bg-gray-700 rounded focus:outline-none">
                <span><i class="bi bi-gear me-2"></i> Settings</span>
                <i :class="openMenu === 6 ? 'rotate-90' : ''" class="bi bi-chevron-right transition-transform"></i>
            </button>
            <div x-show="openMenu === 6" class="pl-6 mt-1 space-y-1 text-gray-300">
                <a href="{% url 'admin_settings_general' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_settings_general' %}bg-gray-800 text-white{% endif %}">General</a>
                <a href="{% url 'admin_settings_payments' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_settings_payments' %}bg-gray-800 text-white{% endif %}">Payment Gateways</a>
                <a href="{% url 'admin_settings_shipping' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name == 'admin_settings_shipping' %}bg-gray-800 text-white{% endif %}">Shipping</a>
                <a href="{% url 'admin_roles_index' %}" class="block px-2 py-1 rounded hover:bg-gray-700 {% if request.resolver_match.url_name|slice:0:11 == 'admin_roles' %}bg-gray-800 text-white{% endif %}">Roles & Permissions</a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-64 flex flex-col min-h-screen">
        <!-- Header -->
        <header class="bg-white border-b border-gray-300 p-4 flex justify-between items-center">
            <button class="md:hidden text-gray-700" @click="$el.closest('.sidebar').classList.toggle('hidden')">
                <i class="bi bi-list text-xl"></i>
            </button>
            <h5 class="text-lg font-medium">CuddlyDuddly Admin</h5>
            <div class="flex items-center space-x-3">
                <span>Hello👋, {{ request.user.get_full_name }}</span>
                <form method="POST" action="{% url 'admin_logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-white text-sm flex items-center space-x-1">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </button>
                </form>
            </div>
        </header>

        <!-- Page Content -->
        <main class="p-6 flex-1">
            {% block content %}
            <!-- Page-specific content goes here -->
            {% endblock %}
        </main>

        <!-- Footer -->
        <footer class="bg-white border-t border-gray-300 p-4 text-center text-gray-600">
            &copy; {{ now|date:"Y" }} Cuddly Duddly. All Rights Reserved.
        </footer>
    </div>

</body>
</html>
